<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Common Structures of Bias • ggdag</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Common Structures of Bias">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggdag</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro-to-ggdag.html">An Introduction to ggdag</a>
    </li>
    <li>
      <a href="../articles/intro-to-dags.html">An Introduction to DAGs</a>
    </li>
    <li>
      <a href="../articles/bias-structures.html">Common Structures of Bias</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/malcolmbarrett/ggdag">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Common Structures of Bias</h1>
                        <h4 class="author">Malcolm Barrett</h4>
            
            <h4 class="date">2019-09-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/malcolmbarrett/ggdag/blob/master/vignettes/bias-structures.Rmd"><code>vignettes/bias-structures.Rmd</code></a></small>
      <div class="hidden name"><code>bias-structures.Rmd</code></div>

    </div>

    
    
<p><em>A quick note on terminology: I use the terms confounding and selection bias below, the terms of choice in epidemiology. The terms, however, depend on the field. In some fields, confounding is referred to as omitted variable bias or selection bias. Selection bias also sometimes refers to</em> variable <em>selection bias, a related issue that refers to misspecified models.</em></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">#  set theme of all DAGs to `theme_dag()`</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggdag)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">theme_set</span>(<span class="kw"><a href="../reference/theme_dag_blank.html">theme_dag</a></span>())</span></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>In addition to helping identify causal effects, the consistency of directed acyclic graphs (DAGs) is very useful in thinking about different forms of bias. Often, many seemingly unrelated types of bias take the same form in a DAG. Methodological issues in a study often reduce to a problem of 1) not adequately blocking a back-door path or 2) selecting on some variable that turns out to be a collider.</p>
</div>
<div id="confounders-and-confounding" class="section level1">
<h1 class="hasAnchor">
<a href="#confounders-and-confounding" class="anchor"></a>Confounders and confounding</h1>
<p>Classical confounding is simple. A confounder is associated with both the exposure and the outcome. Let’s consider a classic example: coffee, smoking, and cancer. Smoking is a risk factor for a number of cancers, and people who drink coffee are more likely to smoke. Coffee doesn’t actually cause lung cancer, but they are d-connected through smoking, so they will appear to be associated:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="../reference/quick_plot.html">confounder_triangle</a></span>(<span class="dt">x =</span> <span class="st">"Coffee"</span>, <span class="dt">y =</span> <span class="st">"Lung Cancer"</span>, <span class="dt">z =</span> <span class="st">"Smoking"</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="st">  </span><span class="kw"><a href="../reference/d_relationship.html">ggdag_dconnected</a></span>(<span class="dt">text =</span> <span class="ot">FALSE</span>, <span class="dt">use_labels =</span> <span class="st">"label"</span>)</span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-1-1.png" width="672" style="display: block; margin: auto;"></p>
<p>But if you think about it, this DAG is incorrect. Smoking doesn’t cause coffee drinking; something else, say a predilection towards addictive substances, causes a person to both smoke and drink coffee. Let’s say that we had a psychometric tool that accurately measures addictive behavior, so we can control for it. Now our DAG looks like this:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>coffee_dag &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dagify.html">dagify</a></span>(cancer <span class="op">~</span><span class="st"> </span>smoking,</span>
<span id="cb3-2"><a href="#cb3-2"></a>       smoking <span class="op">~</span><span class="st"> </span>addictive,</span>
<span id="cb3-3"><a href="#cb3-3"></a>       coffee <span class="op">~</span><span class="st"> </span>addictive,</span>
<span id="cb3-4"><a href="#cb3-4"></a>       <span class="dt">exposure =</span> <span class="st">"coffee"</span>,</span>
<span id="cb3-5"><a href="#cb3-5"></a>       <span class="dt">outcome =</span> <span class="st">"cancer"</span>,</span>
<span id="cb3-6"><a href="#cb3-6"></a>       <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"coffee"</span> =<span class="st"> "Coffee"</span>, <span class="st">"cancer"</span> =<span class="st"> "Lung Cancer"</span>, </span>
<span id="cb3-7"><a href="#cb3-7"></a>                  <span class="st">"smoking"</span> =<span class="st"> "Smoking"</span>, <span class="st">"addictive"</span> =<span class="st"> "Addictive </span><span class="ch">\n</span><span class="st">Behavior"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="st">  </span><span class="kw"><a href="../reference/tidy_dagitty.html">tidy_dagitty</a></span>(<span class="dt">layout =</span> <span class="st">"tree"</span>)</span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="kw"><a href="../reference/ggdag.html">ggdag</a></span>(coffee_dag, <span class="dt">text =</span> <span class="ot">FALSE</span>, <span class="dt">use_labels =</span> <span class="st">"label"</span>)</span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Which one is the confounder, addictive behavior or smoking? Only one or the other needs to be controlled for to block the path:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw"><a href="../reference/adjustment_sets.html">ggdag_adjustment_set</a></span>(coffee_dag, <span class="dt">text =</span> <span class="ot">FALSE</span>, <span class="dt">use_labels =</span> <span class="st">"label"</span>, <span class="dt">shadow =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-3-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Focusing on individual confounders, rather than confounding pathways, is a common error in thinking about adjusting our estimates. We should be more concerned blocking all confounding pathways than with including any particular variable <em>along</em> those pathways. (It’s worth noting, though, that when I say you only need one variable to block a path, that assumes you are measuring and modeling the variable correctly. If, for example, there is measurement error, controlling for that variable may still leave residual confounding, necessitating a more subtle level of control with other variables on the pathway; see the section on measurement error below. Moreover, it’s important to know that you expect to block the path <em>on average</em>; normal sampling issues, e.g. sample size, still come into play.)</p>
</div>
<div id="colliders-m-bias-and-butterfly-bias" class="section level1">
<h1 class="hasAnchor">
<a href="#colliders-m-bias-and-butterfly-bias" class="anchor"></a>Colliders, M-bias, and butterfly bias</h1>
<p>Stratifying on a collider is a major culprit in systematic bias. Controlling for a collider–a node where two or more arrow heads meet–induces an association between its parents, through which confounding can flow:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="../reference/quick_plot.html">collider_triangle</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="st">  </span><span class="kw"><a href="../reference/d_relationship.html">ggdag_dseparated</a></span>(<span class="dt">controlling_for =</span> <span class="st">"m"</span>)</span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Here, the example is fairly simple and easy to deal with: <em>m</em> is a child of <em>x</em> and <em>y</em> and just shouldn’t be adjusted for. It can get more complicated, though, when <em>m</em> is something that seems like it is a confounder or when it represents a variable that contributes to whether or not a person enters the study. Often this takes the form of M-shaped bias, or M-bias. Let’s consider an example from <a href="https://books.google.com/books/about/Modern_Epidemiology.html?id=Z3vjT9ALxHUC">Modern Epidemiology</a>: the association between education and diabetes. Let’s assume that lack of education isn’t a direct cause of diabetes. When we are putting together our analysis, we ask: should we adjust for the participant’s mother’s history of diabetes? It’s linked to education via income and to participant’s diabetes status via genetic risk, so it looks like this:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw"><a href="../reference/quick_plot.html">m_bias</a></span>(<span class="dt">x =</span> <span class="st">"Education"</span>, <span class="dt">y =</span> <span class="st">"Diabetes"</span>, <span class="dt">a =</span> <span class="st">"Income during Childhood"</span>, </span>
<span id="cb6-2"><a href="#cb6-2"></a>       <span class="dt">b =</span> <span class="st">"Genetic Risk </span><span class="ch">\n</span><span class="st">for Diabetes"</span>, <span class="dt">m =</span> <span class="st">"Mother's Diabetes"</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="st">  </span><span class="kw"><a href="../reference/ggdag.html">ggdag</a></span>(<span class="dt">use_labels =</span> <span class="st">"label"</span>)</span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
<p>From a classical confounding perspective, it seems like the mother’s diabetes status might be a confounder: it’s associated with both the exposure and outcome, and it’s not a descendant of either. However, the association with the outcome and exposure is not direct for either; it’s due to confounding by genetic risk and childhood income, respectively. Drawing it as a DAG makes it clear that the mother’s diabetes status is a collider, and adjusting for it will induce an association between genetic risk and childhood income, thus opening a back-door path from education to diabetes status:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="../reference/quick_plot.html">m_bias</a></span>(<span class="dt">x =</span> <span class="st">"Education"</span>, <span class="dt">y =</span> <span class="st">"Diabetes"</span>, <span class="dt">a =</span> <span class="st">"Income during </span><span class="ch">\n</span><span class="st">Childhood"</span>, </span>
<span id="cb7-2"><a href="#cb7-2"></a>       <span class="dt">b =</span> <span class="st">"Genetic Risk </span><span class="ch">\n</span><span class="st">for Diabetes"</span>, <span class="dt">m =</span> <span class="st">"Mother's Diabetes"</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="st">  </span><span class="kw"><a href="../reference/d_relationship.html">ggdag_dseparated</a></span>(<span class="dt">controlling_for =</span> <span class="st">"m"</span>, <span class="dt">use_labels =</span> <span class="st">"label"</span>)</span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-6-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Again, this is relatively easy–just don’t control for the collider. But what about when your study design already stratifies on <em>m</em>? Let’s consider an example where <em>m</em> represents having surgery. Let’s say we are conducting a study involving participants who had surgery due to back pain. We suspect that people who are ready to commit to physical therapy and changes in their daily life will have a greater decrease in pain after a year than those who aren’t. We’ve developed a psychometric tool that measures readiness for surgery, and we are going to look at the association between readiness and change in pain. The readiness scale depends on an underlying latent variable that is true readiness, which we are measuring with some error. Change in pain depends on baseline pain. Both underlying readiness and baseline pain are also predictive of whether or not someone has surgery. By definition, we are selecting on surgical status: we feel it’s unethical to withhold it and irresponsible to force all participants to have surgery. So, we can’t know how people who didn’t have surgery would react. Surgical status is inherently stratified for, because we’re only looking at people who have had it (note that from here on out, I’m not going to show the paths opened by adjusting for a collider, the default in <code>ggdag</code>, for clarity):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>coords &lt;-<span class="st"> </span>dagitty<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/dagitty/topics/coordinates">coordinates</a></span>(<span class="kw"><a href="../reference/quick_plot.html">m_bias</a></span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="st">  </span><span class="kw"><a href="../reference/coordinates.html">coords2df</a></span>()</span>
<span id="cb8-3"><a href="#cb8-3"></a>coords<span class="op">$</span>name &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"readiness"</span>, <span class="st">"pain"</span>, <span class="st">"surgery"</span>, <span class="st">"ready_tool"</span>, <span class="st">"pain_change"</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a></span>
<span id="cb8-5"><a href="#cb8-5"></a>surgical_dag &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dagify.html">dagify</a></span>(ready_tool <span class="op">~</span><span class="st"> </span>readiness,</span>
<span id="cb8-6"><a href="#cb8-6"></a>                       surgery <span class="op">~</span><span class="st"> </span>readiness <span class="op">+</span><span class="st"> </span>pain,</span>
<span id="cb8-7"><a href="#cb8-7"></a>                       pain_change <span class="op">~</span><span class="st"> </span>ready_tool <span class="op">+</span><span class="st"> </span>pain,</span>
<span id="cb8-8"><a href="#cb8-8"></a>                       <span class="dt">exposure =</span> <span class="st">"ready_tool"</span>,</span>
<span id="cb8-9"><a href="#cb8-9"></a>                       <span class="dt">outcome =</span> <span class="st">"pain_change"</span>,</span>
<span id="cb8-10"><a href="#cb8-10"></a>                       <span class="dt">latent =</span> <span class="st">"readiness"</span>,</span>
<span id="cb8-11"><a href="#cb8-11"></a>                       <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">ready_tool =</span> <span class="st">"Measured </span><span class="ch">\n</span><span class="st">Readiness"</span>, </span>
<span id="cb8-12"><a href="#cb8-12"></a>                                  <span class="dt">pain_change =</span> <span class="st">"Change </span><span class="ch">\n</span><span class="st">in Pain"</span>, </span>
<span id="cb8-13"><a href="#cb8-13"></a>                                  <span class="dt">readiness =</span> <span class="st">"Underlying </span><span class="ch">\n</span><span class="st">Readiness"</span>, </span>
<span id="cb8-14"><a href="#cb8-14"></a>                                  <span class="dt">pain =</span> <span class="st">"Baseline </span><span class="ch">\n</span><span class="st">Pain"</span>, </span>
<span id="cb8-15"><a href="#cb8-15"></a>                                  <span class="dt">surgery =</span> <span class="st">"Surgical </span><span class="ch">\n</span><span class="st">Status"</span>),</span>
<span id="cb8-16"><a href="#cb8-16"></a>                       <span class="dt">coords =</span> <span class="kw"><a href="../reference/coordinates.html">coords2list</a></span>(coords)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="st">  </span><span class="kw"><a href="../reference/control_for.html">control_for</a></span>(<span class="st">"surgery"</span>)</span>
<span id="cb8-18"><a href="#cb8-18"></a></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="kw"><a href="../reference/control_for.html">ggdag_adjust</a></span>(surgical_dag, <span class="dt">text =</span> <span class="ot">FALSE</span>, <span class="dt">use_labels =</span> <span class="st">"label"</span>, <span class="dt">collider_lines =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can’t unstratify by surgical status, so our best bet is to block the back-door path opened by stratifying on it. We can’t adjust for the latent variable (and, if we’re measuring it really well, the latent variable and the tool are one in the same), so all we can do is control for baseline pain. Note that, technically, surgical status is part of the adjustment set:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="../reference/adjustment_sets.html">ggdag_adjustment_set</a></span>(surgical_dag, <span class="dt">text =</span> <span class="ot">FALSE</span>, <span class="dt">use_labels =</span> <span class="st">"label"</span>, <span class="dt">shadow =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<p>What about if a variable is both a collider and a cause of the exposure and outcome (a classical confounder)? This is an extension of M-bias sometimes called butterfly bias or bow-tie bias. The variable is a part of two paths: one that it’s blocking as a collider <em>and</em> a back-door path that is confounding the relationship between <em>x</em> and <em>y</em>. What to do?</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw"><a href="../reference/quick_plot.html">ggdag_butterfly_bias</a></span>(<span class="dt">edge_type =</span> <span class="st">"diagonal"</span>)</span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The strategy is basically the same as above; we need to control for <em>m</em> to block the back-door path, but that opens up a relationship between <em>a</em> and <em>b</em>, so we need to block that path, too.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw"><a href="../reference/adjustment_sets.html">ggdag_adjustment_set</a></span>(<span class="kw"><a href="../reference/quick_plot.html">butterfly_bias</a></span>(), <span class="dt">shadow =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Adjusting for either set, {<em>a</em>, <em>m</em>} or {<em>b</em>, <em>m</em>}, will give allow us to estimate the causal effect of <em>x</em> on <em>y</em>.</p>
</div>
<div id="measurement-error" class="section level1">
<h1 class="hasAnchor">
<a href="#measurement-error" class="anchor"></a>Measurement error</h1>
<p>Measurement error is the degree to which we mismeasure a variable, which can lead to bias in a number of ways. If the error is dependent on the exposure or the outcome, (e.g. we measure the exposure with less accuracy for a group without a disease than with it), it is called differential measurement error. If the error has nothing to do with the exposure or outcome, it’s called non-differential measurement error. Under most conditions, non-differential error will bias the estimate of effect towards the null. In this way, it’s at least predictable, but for small effects or inadequately powered studies, it can make a true effect disappear. If there is error in both the exposure and outcome, the errors themselves can also be associated, opening a back-door path between the exposure and outcome.</p>
<p>Let’s consider an example with non-differential error for the outcome and differential error for the exposure. One common situation where this can occur is recall bias. Let’s say we want to know if taking multivitamins in childhood helps protect against bladder cancer later in life.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># set coordinates</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>coords &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span>(</span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="op">~</span>name,            <span class="op">~</span>x,  <span class="op">~</span>y,</span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="st">"bladder_cancer"</span>,    <span class="dv">1</span>,   <span class="dv">0</span>,</span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="st">"vitamins"</span>,          <span class="dv">0</span>,   <span class="dv">0</span>,</span>
<span id="cb12-6"><a href="#cb12-6"></a>  <span class="st">"diagnosed_bc"</span>,      <span class="dv">1</span>,   <span class="dv">1</span>,</span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="st">"recalled_vits"</span>,     <span class="dv">0</span>,   <span class="dv">1</span>,</span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="st">"bc_error"</span>,          <span class="dv">1</span>,   <span class="dv">2</span>,</span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="st">"vits_error"</span>,        <span class="dv">0</span>,   <span class="dv">2</span>,</span>
<span id="cb12-10"><a href="#cb12-10"></a>)</span>
<span id="cb12-11"><a href="#cb12-11"></a></span>
<span id="cb12-12"><a href="#cb12-12"></a>bladder_dag &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dagify.html">dagify</a></span>(diagnosed_bc <span class="op">~</span><span class="st"> </span>bc_error <span class="op">+</span><span class="st"> </span>bladder_cancer,</span>
<span id="cb12-13"><a href="#cb12-13"></a>                      recalled_vits <span class="op">~</span><span class="st"> </span>vitamins <span class="op">+</span><span class="st"> </span>vits_error,</span>
<span id="cb12-14"><a href="#cb12-14"></a>                      vits_error <span class="op">~</span><span class="st"> </span>bladder_cancer,</span>
<span id="cb12-15"><a href="#cb12-15"></a>                      <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">bladder_cancer =</span> <span class="st">"Bladder Cancer"</span>,</span>
<span id="cb12-16"><a href="#cb12-16"></a>                                 <span class="dt">vitamins =</span> <span class="st">"Childhood Vitamin </span><span class="ch">\n</span><span class="st">Intake"</span>,</span>
<span id="cb12-17"><a href="#cb12-17"></a>                                 <span class="dt">diagnosed_bc =</span> <span class="st">"Diagnosed </span><span class="ch">\n</span><span class="st">Bladder Cancer"</span>,</span>
<span id="cb12-18"><a href="#cb12-18"></a>                                 <span class="dt">recalled_vits =</span> <span class="st">"Memory of </span><span class="ch">\n</span><span class="st">Taking Vitamins"</span>, </span>
<span id="cb12-19"><a href="#cb12-19"></a>                                 <span class="dt">bc_error =</span> <span class="st">"Measurement Error, </span><span class="ch">\n</span><span class="st">Diagnosis"</span>,</span>
<span id="cb12-20"><a href="#cb12-20"></a>                                 <span class="dt">vits_error =</span> <span class="st">"Measurement Error, </span><span class="ch">\n</span><span class="st">Vitamins"</span>),</span>
<span id="cb12-21"><a href="#cb12-21"></a>                      <span class="dt">coords =</span> coords)</span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="kw"><a href="../reference/ggdag.html">ggdag</a></span>(bladder_dag, <span class="dt">text =</span> <span class="ot">FALSE</span>, <span class="dt">use_labels =</span> <span class="st">"label"</span>)</span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></p>
<p>For the outcome, the bias only depends on how well diagnosis of bladder cancer represents actually having bladder cancer. For the exposure, however, it also depends on if you have cancer or not: people who are sick tend to spend more time reflecting on what could have caused the illness. Thus, they will remember the vitamins they took as children, on average, a little better than controls. If there is no effect of vitamins on bladder cancer, this dependency will make it seem as if vitamins are a <em>risk</em> for bladder cancer. If it is, in fact, protective, recall bias can reduce or even reverse the association.</p>
<p>Measurement error can also cause bias in longitudinal settings. Let’s consider another example from Modern Epidemiology, which uses the Centers for Epidemiologic Studies–Depression (CES-D) scale, a common tool to assess depression that is known to have measurement error. In this example, the question is if graduating from college with an honors degree affects how depression changes after graduation. Assuming it doesn’t, adjusting for baseline CES-D score–a common practice–can induce bias via measurement error:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># set coordinates</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>coords &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span>(</span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="op">~</span>name,              <span class="op">~</span>x,  <span class="op">~</span>y,</span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="st">"honors"</span>,            <span class="dv">1</span>,   <span class="dv">3</span>,</span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="st">"depression"</span>,        <span class="dv">2</span>,   <span class="dv">3</span>,</span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="st">"cesd"</span>,              <span class="dv">2</span>,   <span class="dv">2</span>,</span>
<span id="cb13-7"><a href="#cb13-7"></a>  <span class="st">"baseline_error"</span>,    <span class="dv">2</span>,   <span class="dv">1</span>,</span>
<span id="cb13-8"><a href="#cb13-8"></a>  <span class="st">"depression_change"</span>, <span class="dv">3</span>,   <span class="dv">3</span>,</span>
<span id="cb13-9"><a href="#cb13-9"></a>  <span class="st">"cesd_change"</span>,       <span class="dv">3</span>,   <span class="dv">2</span>,</span>
<span id="cb13-10"><a href="#cb13-10"></a>  <span class="st">"followup_error"</span>,    <span class="dv">3</span>,   <span class="dv">1</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>)</span>
<span id="cb13-12"><a href="#cb13-12"></a></span>
<span id="cb13-13"><a href="#cb13-13"></a>cesd_dag &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dagify.html">dagify</a></span>(depression <span class="op">~</span><span class="st"> </span>honors,</span>
<span id="cb13-14"><a href="#cb13-14"></a>       cesd <span class="op">~</span><span class="st"> </span>depression <span class="op">+</span><span class="st"> </span>baseline_error,</span>
<span id="cb13-15"><a href="#cb13-15"></a>       cesd_change <span class="op">~</span><span class="st"> </span>depression_change <span class="op">+</span><span class="st"> </span>followup_error <span class="op">+</span><span class="st"> </span>baseline_error,</span>
<span id="cb13-16"><a href="#cb13-16"></a>                      <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">honors =</span> <span class="st">"Honors Degree"</span>,</span>
<span id="cb13-17"><a href="#cb13-17"></a>                                 <span class="dt">depression =</span> <span class="st">"Depression"</span>,</span>
<span id="cb13-18"><a href="#cb13-18"></a>                                 <span class="dt">cesd =</span> <span class="st">"CES-D"</span>,</span>
<span id="cb13-19"><a href="#cb13-19"></a>                                 <span class="dt">cesd_change =</span> <span class="st">"Change </span><span class="ch">\n</span><span class="st">in CES-D"</span>,</span>
<span id="cb13-20"><a href="#cb13-20"></a>                                 <span class="dt">depression_change =</span> <span class="st">"Change in </span><span class="ch">\n</span><span class="st">Depression"</span>, </span>
<span id="cb13-21"><a href="#cb13-21"></a>                                 <span class="dt">baseline_error =</span> <span class="st">"Measurement Error, </span><span class="ch">\n</span><span class="st">Baseline"</span>,</span>
<span id="cb13-22"><a href="#cb13-22"></a>                                 <span class="dt">followup_error =</span> <span class="st">"Measurement Error, </span><span class="ch">\n</span><span class="st">Follow-up"</span>),</span>
<span id="cb13-23"><a href="#cb13-23"></a>       <span class="dt">coords =</span> coords)</span>
<span id="cb13-24"><a href="#cb13-24"></a></span>
<span id="cb13-25"><a href="#cb13-25"></a>cesd_dag <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-26"><a href="#cb13-26"></a><span class="st">  </span><span class="kw"><a href="../reference/d_relationship.html">ggdag_dconnected</a></span>(<span class="dt">from =</span> <span class="st">"honors"</span>, <span class="dt">to =</span> <span class="st">"cesd_change"</span>, <span class="dt">controlling_for =</span> <span class="st">"cesd"</span>, </span>
<span id="cb13-27"><a href="#cb13-27"></a>                   <span class="dt">text =</span> <span class="ot">FALSE</span>, <span class="dt">use_labels =</span> <span class="st">"label"</span>, <span class="dt">collider_lines =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Because both the baseline score and the change are due, in part, to measurement error at baseline, controlling for baseline CES-D score (a collider) causes change in CES-D and receiving an honors degree to be d-connected.</p>
</div>
<div id="selection-bias" class="section level1">
<h1 class="hasAnchor">
<a href="#selection-bias" class="anchor"></a>Selection bias</h1>
<p>We have already seen a few examples of selection bias, but let’s consider a couple more that are potential pitfalls in common design types. Let’s say we’re doing a case-control study and want to assess the effect of smoking on glioma, a type of brain cancer. We have a group of glioma patients at a hospital and want to compare them to a group of controls, so we pick people in the hospital with a broken bone, since that seems to have nothing to do with brain cancer. However, perhaps there is some unknown confounding between smoking and being in the hospital with a broken bone, like being prone to reckless behavior. In the normal population, there is no causal effect of smoking on glioma, but in our case, we’re selecting on people who have been hospitalized, which opens up a back-door path:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>coords &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span>(</span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="op">~</span>name,           <span class="op">~</span>x,  <span class="op">~</span>y,</span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="st">"glioma"</span>,         <span class="dv">1</span>,   <span class="dv">2</span>,</span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="st">"hospitalized"</span>,   <span class="dv">2</span>,   <span class="dv">3</span>,</span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="st">"broken_bone"</span>,    <span class="dv">3</span>,   <span class="dv">2</span>,</span>
<span id="cb14-6"><a href="#cb14-6"></a>  <span class="st">"reckless"</span>,       <span class="dv">4</span>,   <span class="dv">1</span>,</span>
<span id="cb14-7"><a href="#cb14-7"></a>  <span class="st">"smoking"</span>,        <span class="dv">5</span>,   <span class="dv">2</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>)</span>
<span id="cb14-9"><a href="#cb14-9"></a></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="kw"><a href="../reference/dagify.html">dagify</a></span>(hospitalized <span class="op">~</span><span class="st"> </span>broken_bone <span class="op">+</span><span class="st"> </span>glioma,</span>
<span id="cb14-11"><a href="#cb14-11"></a>       broken_bone <span class="op">~</span><span class="st"> </span>reckless,</span>
<span id="cb14-12"><a href="#cb14-12"></a>       smoking <span class="op">~</span><span class="st"> </span>reckless,</span>
<span id="cb14-13"><a href="#cb14-13"></a>       <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">hospitalized =</span> <span class="st">"Hospitalization"</span>,</span>
<span id="cb14-14"><a href="#cb14-14"></a>                  <span class="dt">broken_bone =</span> <span class="st">"Broken Bone"</span>,</span>
<span id="cb14-15"><a href="#cb14-15"></a>                  <span class="dt">glioma =</span> <span class="st">"Glioma"</span>,</span>
<span id="cb14-16"><a href="#cb14-16"></a>                  <span class="dt">reckless =</span> <span class="st">"Reckless </span><span class="ch">\n</span><span class="st">Behavior"</span>,</span>
<span id="cb14-17"><a href="#cb14-17"></a>                  <span class="dt">smoking =</span> <span class="st">"Smoking"</span>),</span>
<span id="cb14-18"><a href="#cb14-18"></a>       <span class="dt">coords =</span> coords) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="st">  </span><span class="kw"><a href="../reference/d_relationship.html">ggdag_dconnected</a></span>(<span class="st">"glioma"</span>, <span class="st">"smoking"</span>, <span class="dt">controlling_for =</span> <span class="st">"hospitalized"</span>, </span>
<span id="cb14-20"><a href="#cb14-20"></a>                   <span class="dt">text =</span> <span class="ot">FALSE</span>, <span class="dt">use_labels =</span> <span class="st">"label"</span>, <span class="dt">collider_lines =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Even though smoking doesn’t actually cause glioma, it will appear as if there is an association. Actually, in this case, it may make smoking appear to be <em>protective</em> against glioma, since controls are more likely to be smokers.</p>
<p>Let’s also consider how bias arises in loss-to-follow-up. In a randomized clinical trial or cohort study, the main threat of selection bias is not through who enters the study (although that may affect generalizability) but who leaves it. If loss-to-follow-up is associated with the exposure or outcome, the relationship between the two may be biased. Let’s consider a trial where we are testing a new HIV drug and its effect on CD4 white blood cell count. If the treatment causes symptoms, participants may leave the trial. Similarly, there may be those whose HIV is getting worse and thus more symptomatic, which also may cause people to leave the trial. If we only have information on people who stay in the study, we are stratifying by follow-up status:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw"><a href="../reference/dagify.html">dagify</a></span>(follow_up <span class="op">~</span><span class="st"> </span>symptoms,</span>
<span id="cb15-2"><a href="#cb15-2"></a>       symptoms <span class="op">~</span><span class="st"> </span>new_rx <span class="op">+</span><span class="st"> </span>dx_severity,</span>
<span id="cb15-3"><a href="#cb15-3"></a>       cd4 <span class="op">~</span><span class="st"> </span>dx_severity,</span>
<span id="cb15-4"><a href="#cb15-4"></a>       <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(</span>
<span id="cb15-5"><a href="#cb15-5"></a>         <span class="dt">follow_up =</span> <span class="st">"Follow-Up"</span>,</span>
<span id="cb15-6"><a href="#cb15-6"></a>         <span class="dt">symptoms =</span> <span class="st">"Symptoms"</span>,</span>
<span id="cb15-7"><a href="#cb15-7"></a>         <span class="dt">new_rx =</span> <span class="st">"New HIV Drug"</span>,</span>
<span id="cb15-8"><a href="#cb15-8"></a>         <span class="dt">dx_severity =</span> <span class="st">"Underyling </span><span class="ch">\n</span><span class="st">HIV Severity"</span>,</span>
<span id="cb15-9"><a href="#cb15-9"></a>         <span class="dt">cd4 =</span> <span class="st">"CD4 Count"</span></span>
<span id="cb15-10"><a href="#cb15-10"></a>       )) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="st">  </span><span class="kw"><a href="../reference/control_for.html">ggdag_adjust</a></span>(<span class="st">"follow_up"</span>, <span class="dt">layout =</span> <span class="st">"mds"</span>, <span class="dt">text =</span> <span class="ot">FALSE</span>, </span>
<span id="cb15-12"><a href="#cb15-12"></a>               <span class="dt">use_labels =</span> <span class="st">"label"</span>, <span class="dt">collider_lines =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="bias-structures_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;"></p>
<p>But follow-up is downstream from a collider, symptoms. Controlling for a downstream collider induces bias and, because we only have information on people who remain in the study, we are inadvertently stratifying on follow-up status (see the <a href="intro-to-dags.html">vignette introducing DAGs</a> for more on downstream colliders). Thus, the effect estimate between the HIV drug and CD4 count will be biased.</p>
</div>
<div id="resources" class="section level1">
<h1 class="hasAnchor">
<a href="#resources" class="anchor"></a>Resources</h1>
<p>Many, if not all, forms of systematic bias can be drawn as DAGs. Here are a few sources with interesting examples:</p>
<ul>
<li>Miguel Hernán’s course on DAGs includes a number of examples on common structures of bias: <a href="https://www.edx.org/course/causal-diagrams-draw-assumptions-harvardx-ph559x">Causal Diagrams: Draw Your Assumptions Before Your Conclusions</a>. Also see his article <a href="https://www.ncbi.nlm.nih.gov/pubmed/15308962">A structural approach to selection bias</a>.</li>
<li>The chapter on DAGs in <a href="https://books.google.com/books/about/Modern_Epidemiology.html?id=Z3vjT9ALxHUC">Modern Epidemiology</a> includes a couple of the examples here and many more directly related to conducting observational research, including measurement error, selection bias, residual confounding, and missing data.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#confounders-and-confounding">Confounders and confounding</a></li>
      <li><a href="#colliders-m-bias-and-butterfly-bias">Colliders, M-bias, and butterfly bias</a></li>
      <li><a href="#measurement-error">Measurement error</a></li>
      <li><a href="#selection-bias">Selection bias</a></li>
      <li><a href="#resources">Resources</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://malco.io">Malcolm Barrett</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
